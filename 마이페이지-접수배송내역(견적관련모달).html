<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>모바일 최적화 모달 데모 (파일 업로드 UI 통합)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* =========================================
           [v12] Master Guide CSS Reset & Base
           ========================================= */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html,
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f5f7;
            color: #333;
            font-size: 16px;
            line-height: 1.6;
            overflow-x: visible;
        }

        ul,
        li {
            list-style: none;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            font-family: inherit;
            border: none;
            cursor: pointer;
            background: none;
            padding: 0;
        }

        img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: block;
        }

        input,
        textarea,
        select {
            font-family: inherit;
        }

        svg {
            stroke-width: 2;
            fill: none;
            stroke: currentColor;
            stroke-linecap: round;
            stroke-linejoin: round;
            flex-shrink: 0;
            display: block;
        }

        /* Layout & Header */
        .mobile-wrap {
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
            background-color: #ffffff;
            min-height: 100vh;
        }

        .sw-container {
            padding: 24px 20px;
        }

        .app-header-sub {
            height: 56px;
            background: #ffffff;
            border-bottom: 1px solid #cccccc;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            flex-shrink: 0;
        }

        .header-title {
            flex: 3 0 0;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            color: #212121;
        }

        .header-left,
        .header-right {
            flex: 1 0 0;
            display: flex;
            align-items: center;
        }

        .header-left {
            justify-content: flex-start;
        }

        .header-right {
            justify-content: flex-end;
        }

        .header-btn {
            width: 28px;
            height: 28px;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Buttons */
        .dark-button {
            background: #424242;
            color: white;
            height: 44px;
            padding: 7px 19px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: fit-content;
            transition: background 0.1s;
        }

        .dark-button:disabled {
            background: #cccccc;
            color: #ffffff;
            cursor: default;
        }

        .white-button {
            background: white;
            color: #424242;
            height: 44px;
            padding: 7px 19px;
            border-radius: 6px;
            border: 1px solid #e8e8e9;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: fit-content;
            transition: background 0.1s;
        }

        /* Form & Input */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .input {
            width: 100%;
            min-height: 44px;
            background: white;
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            padding: 10px 12px;
            display: flex;
            align-items: center;
            position: relative;
        }

        .input input {
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            font-size: 14px;
            color: black;
            line-height: 1.5;
            min-height: 20px;
        }

        .input textarea {
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            font-size: 14px;
            color: black;
            line-height: 1.5;
            resize: vertical;
            min-height: 100px;
            padding: 0;
        }

        .input-read-only {
            background-color: #f8f8f9;
        }

        .input-read-only .product-name {
            font-weight: 600;
            color: #333;
            display: block;
            margin-bottom: 4px;
        }

        .input-read-only .product-options li {
            font-size: 14px;
            color: #555;
            margin-bottom: 2px;
        }

        .disclaimer {
            font-size: 12px;
            color: #888;
            margin-top: 8px;
            line-height: 1.5;
        }

        /* Full Modal Standard */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 0;
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeInModal 0.2s ease-out;
        }

        @keyframes fadeInModal {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .full-modal-content {
            width: 100%;
            height: 100%;
            max-width: 480px;
            max-height: 100%;
            display: flex;
            flex-direction: column;
            animation: slideInUp 0.3s ease-out;
            margin: 0 auto;
            background: white;
            border-radius: 0;
        }

        @keyframes slideInUp {
            from {
                transform: translateY(100%);
            }

            to {
                transform: translateY(0);
            }
        }

        /* [MODIFIED] Full Modal Header (Left Align Standard) */
        .modal-header-full {
            height: 56px;
            background: white;
            border-bottom: 1px solid #cccccc;
            display: flex;
            align-items: center;
            padding: 0 16px;
            flex-shrink: 0;
            position: relative;
            /* Added for absolute close button */
        }

        .modal-title-full {
            flex: 1;
            /* Changed from flex: 3 0 0 */
            font-size: 18px;
            font-weight: 700;
            /* Changed from 600 */
            text-align: left;
            /* Changed from center */
            color: #212121;
        }

        .btn-modal-close-full {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            cursor: pointer;
            color: #333;
            /* Position absolute for right alignment */
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
        }

        .modal-body-full {
            padding: 16px;
            overflow-y: auto;
            flex-grow: 1;
        }

        .modal-footer-full {
            padding: 16px;
            border-top: 1px solid #e8e8e9;
            background: #fff;
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .modal-footer-full .dark-button {
            width: 100%;
        }

        /* =========================================
           [UI Component] File Upload (from design_choice)
           ========================================= */
        .modal-tab-nav {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        .single-chip {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 6px 12px;
            border-radius: 100px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }

        .single-chip-off {
            background: #f5f5f6;
            color: #8a8a92;
        }

        .single-chip-on {
            background: #4e6ee4;
            color: white;
        }

        /* [수정됨] 정렬 문제 해결: display: flex 및 center 정렬 적용 */
        .form-group label.file-upload-button {
            height: 44px;
            font-weight: 500;
            width: 100%;
            display: flex;
            /* flex로 변경하여 정렬 제어 */
            align-items: center;
            /* 수직 중앙 */
            justify-content: center;
            /* 수평 중앙 */
            gap: 6px;
            margin-bottom: 8px;
            line-height: 1;
            /* 높이 영향 최소화 */
        }

        .file-upload-button svg {
            width: 18px;
            height: 18px;
            display: block;
            /* SVG 하단 여백 제거 */
        }

        .file-list-container {
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            margin-top: 12px;
            display: none;
            /* Initial hidden */
        }

        .file-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            border-bottom: 1px solid #e8e8e9;
        }

        .file-list-header .total-count {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .file-list-header .total-size {
            font-size: 13px;
            color: #888;
        }

        .file-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .file-item .file-name {
            flex: 1;
            font-size: 14px;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-item .file-size {
            font-size: 13px;
            color: #888;
            flex-shrink: 0;
        }

        .file-item .remove-btn {
            width: 20px;
            height: 20px;
            color: #888;
            flex-shrink: 0;
            cursor: pointer;
        }

        .file-item .remove-btn:hover {
            color: #dc3545;
        }

        /* =========================================
           [UI Component] Combobox (for Country Code)
           ========================================= */
        .input-group {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .combobox-wrapper {
            position: relative;
            flex: 1;
        }

        .combobox-wrapper-small {
            flex: 0 1 140px;
        }

        .combobox-dropdown {
            position: absolute;
            top: calc(100% + 2px);
            left: 0;
            right: 0;
            background: #fff;
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            z-index: 100;
            max-height: 220px;
            overflow-y: auto;
            display: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .combobox-item {
            padding: 10px 12px;
            font-size: 14px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .combobox-item:last-child {
            border-bottom: none;
        }

        .combobox-item:hover {
            background: #f5f5f6;
        }

        .combobox-item strong {
            font-weight: 600;
            color: #333;
            flex-shrink: 0;
            margin-left: 5px;
        }

        .combobox-item span {
            font-size: 14px;
            color: #555;
        }

        .combobox-item .flag,
        .select-flag {
            flex-shrink: 0;
            display: inline-flex;
            align-items: center;
        }

        .combobox-item .flag img,
        .select-flag img {
            width: 20px;
            height: auto;
            border-radius: 2px;
        }

        .combobox-wrapper .input.select-wrapper {
            padding: 0;
            align-items: stretch;
            cursor: pointer;
        }

        .combobox-wrapper .input.select-wrapper .select-flag {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1;
        }

        .combobox-wrapper .input.select-wrapper input {
            height: 42px;
            line-height: 42px;
            padding: 0 12px 0 40px;
            background: transparent;
            z-index: 2;
            cursor: pointer;
        }

        .combobox-wrapper .input.select-wrapper::after {
            content: '';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23555' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6l6 -6' /%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
            pointer-events: none;
            z-index: 3;
        }

        /* [UI Component] Quote Selection Card & Checkbox */
        .quote-select-message {
            font-size: 14px;
            color: #888;
            margin-bottom: 16px;
        }

        .quote-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .common-table-card.quote-select-card {
            padding: 12px 15px;
            cursor: pointer;
            transition: border-color 0.2s, background-color 0.2s;
            position: relative;
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            background: white;
        }

        .common-table-card.quote-select-card.selected {
            border-color: #4e6ee4;
            background-color: #f8fbff;
        }

        .quote-card-header-main {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin-bottom: 0;
        }

        .quote-card-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-right: 10px;
        }

        .quote-spec {
            font-size: 13px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 0;
        }

        .card-divider {
            width: 100%;
            height: 1px;
            background: #e8e8e9;
            margin: 10px 0;
        }

        .checkbox-text-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
            flex: 1;
            min-width: 0;
        }

        .checkbox-text-wrapper .checkbox {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            position: relative;
        }

        .checkbox-text-wrapper .checkbox-off {
            width: 100%;
            height: 100%;
            background: white;
            border: 1px solid #bdbdbd;
            border-radius: 2px;
        }

        .checkbox-text-wrapper .checkbox-on {
            width: 100%;
            height: 100%;
            background: #4e6ee4;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checkbox-text-wrapper .checkbox-on img {
            width: 14px;
            height: 14px;
        }

        .quote-date {
            font-size: 13px;
            font-weight: 500;
            color: #888;
            flex-shrink: 0;
        }

        /* 이메일 자동완성 스타일 */
        .combobox-wrapper {
            position: relative;
            width: 100%;
        }

        /* 드롭다운 박스 */
        .combobox-dropdown {
            position: absolute;
            top: calc(100% + 2px);
            /* 인풋 바로 아래 위치 */
            left: 0;
            right: 0;
            background: #fff;
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            z-index: 600;
            /* 다른 요소보다 위에 뜨도록 설정 */
            max-height: 150px;
            /* 너무 길어지면 스크롤 */
            overflow-y: auto;
            display: none;
            /* 기본적으로 숨김 */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        /* 드롭다운 아이템 */
        .combobox-item {
            padding: 10px 12px;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            width: 100%;
            display: block;
            text-align: left;
            background: #fff;
            transition: background-color 0.2s;
        }

        .combobox-item:last-child {
            border-bottom: none;
        }

        .combobox-item:hover {
            background: #f5f5f6;
            /* 마우스 오버 시 배경색 */
        }
    </style>
</head>

<body>

    <div class="mobile-wrap">
        <header class="app-header-sub">
            <div class="header-left">
                <button type="button" class="header-btn" onclick="history.back();">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        id="icon-chevron-left">
                        <path d="M15 6l-6 6l6 6" />
                    </svg>
                </button>
            </div>
            <h1 class="header-title">견적 관련</h1>
            <div class="header-right">
            </div>
        </header>
        <main class="sw-container">
            <div style="display: flex; flex-direction: column; gap: 10px; ">
                <button class="white-button" style="height: 44px; width: 100%;"
                    onclick="openModal('quote-select-modal-overlay')">1. 견적 선택 모달 (최대 2개 선택)</button>
                <button class="white-button" style="height: 44px; width: 100%;"
                    onclick="openModal('auth-quote-apply-modal-overlay')">2. 별도견적 신청 모달: 회원</button>
                <button class="white-button" style="height: 44px; width: 100%;"
                    onclick="openModal('unauth-quote-apply-modal-overlay')">3. 별도견적 신청 모달: 비회원</button>
            </div>
        </main>
    </div>

    <div class="modal-overlay" id="quote-select-modal-overlay">
        <div class="full-modal-content" id="quote-select-modal">
            <header class="modal-header-full">
                <h1 class="modal-title-full">견적 비교</h1>
                <button type="button" class="btn-modal-close-full" onclick="closeModal('quote-select-modal-overlay')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M18 6l-12 12" />
                        <path d="M6 6l12 12" />
                    </svg>
                </button>
            </header>
            <div class="modal-body-full">
                <p class="quote-select-message">비교할 견적을 선택해주세요 (최대 2건)</p>
                <div class="quote-list" id="quote-list-container">

                    <div class="common-table-card quote-select-card" data-quote-id="1"
                        onclick="toggleQuoteSelection(this)">
                        <div class="quote-card-header-main">
                            <div class="checkbox-text-wrapper" data-checkbox-role="toggle-select">
                                <div class="checkbox" data-checked="false">
                                    <div class="checkbox-off"></div>
                                </div>
                                <span class="quote-card-title">[일반 명함] 사원용 명함 견적</span>
                            </div>
                            <span class="quote-date">2025-09-16</span>
                        </div>
                        <div class="card-divider" style="margin: 10px 0;"></div>
                        <div class="quote-spec">아르떼 울트라화이트 310g/208×154 / 양면칼라 8도 / 디지털인쇄(인디고)/...</div>
                    </div>

                    <div class="common-table-card quote-select-card" data-quote-id="2"
                        onclick="toggleQuoteSelection(this)">
                        <div class="quote-card-header-main">
                            <div class="checkbox-text-wrapper" data-checkbox-role="toggle-select">
                                <div class="checkbox" data-checked="false">
                                    <div class="checkbox-off"></div>
                                </div>
                                <span class="quote-card-title">[책자] 기업 홍보용 책자 (마감 임박)</span>
                            </div>
                            <span class="quote-date">2025-08-16</span>
                        </div>
                        <div class="card-divider" style="margin: 10px 0;"></div>
                        <div class="quote-spec">용지: 누브지/220g | 인쇄: 양면CMYK/고급 | 사이즈: 210x297mm / 중철</div>
                    </div>

                    <div class="common-table-card quote-select-card selected" data-quote-id="3"
                        onclick="toggleQuoteSelection(this)">
                        <div class="quote-card-header-main">
                            <div class="checkbox-text-wrapper" data-checkbox-role="toggle-select">
                                <div class="checkbox" data-checked="true">
                                    <div class="checkbox-on"><img src="assets/images/checked.svg" alt="체크"></div>
                                </div>
                                <span class="quote-card-title">[별도견적] 특수용지 명함</span>
                            </div>
                            <span class="quote-date">2025-09-01</span>
                        </div>
                        <div class="card-divider" style="margin: 10px 0;"></div>
                        <div class="quote-spec">마분지 360g/4도 별색 / 형압 가공 추가 / 500매</div>
                    </div>

                    <div class="common-table-card quote-select-card selected" data-quote-id="4"
                        onclick="toggleQuoteSelection(this)">
                        <div class="quote-card-header-main">
                            <div class="checkbox-text-wrapper" data-checkbox-role="toggle-select">
                                <div class="checkbox" data-checked="true">
                                    <div class="checkbox-on"><img src="assets/images/checked.svg" alt="체크"></div>
                                </div>
                                <span class="quote-card-title">[홍보물] A4 전단지 2종</span>
                            </div>
                            <span class="quote-date">2025-08-20</span>
                        </div>
                        <div class="card-divider" style="margin: 10px 0;"></div>
                        <div class="quote-spec">아트지 100g/양면 CMYK / 접지(2단) / 10,000매</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer-full">
                <button class="dark-button" id="quote-select-complete-btn" onclick="handleQuoteSelectComplete()">선택
                    완료</button>
            </div>
        </div>
    </div>


    <div class="modal-overlay" id="auth-quote-apply-modal-overlay">
        <div class="full-modal-content" id="auth-quote-apply-modal">
            <header class="modal-header-full">
                <h1 class="modal-title-full">별도견적 신청</h1>
                <button type="button" class="btn-modal-close-full"
                    onclick="closeModal('auth-quote-apply-modal-overlay')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M18 6l-12 12" />
                        <path d="M6 6l12 12" />
                    </svg>
                </button>
            </header>
            <div class="modal-body-full">
                <div class="form-group">
                    <label>선택 옵션</label>
                    <div class="input input-read-only"
                        style="flex-direction: column; align-items: flex-start; justify-content: flex-start; min-height: 70px; padding: 12px;">
                        <span class="product-name">책자</span>
                        <ul class="product-options" style="list-style: disc; padding-left: 0;">
                            <li>용지: (표지)아트지/백색/ 100g, (내지) 아트지/백색/100g</li>
                            <li>인쇄: (표지) 양면 / CMYK / 일반, (내지) 단면/K/일반</li>
                            <li>사이즈: A4(210×195mm)</li>
                            <li>가공: 박/오시/도무송</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group">
                    <label for="auth-quote-detail">견적 요청 상세</label>
                    <div class="input" style="align-items: flex-start; min-height: 120px;">
                        <textarea id="auth-quote-detail"
                            placeholder="원하시는 옵션과 요청사항을 가능한 자세히 입력해주세요 (ex. 특수 용지 사용, 대량 인쇄(10,000,000매) 등)"></textarea>
                    </div>
                    <div class="disclaimer">0/1,000</div>
                </div>

                <div class="form-group">
                    <label for="auth-phone">휴대폰 번호</label>
                    <div class="input">
                        <input type="tel" id="auth-phone" value="01012641234">
                    </div>
                    <p class="disclaimer">* 별도견적 시 확인 필요사항이 있을 경우 연락 가능한 휴대폰 번호를 입력해주세요</p>
                </div>

                <div class="form-group" style="padding-bottom: 10px; margin-bottom: 20px;">
                    <label style="margin-bottom: 12px;">파일 업로드(선택)</label>

                    <label for="auth-file-upload" class="white-button file-upload-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                            <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                            <path d="M12 11v6" />
                            <path d="M9 14l3 -3l3 3" />
                        </svg>
                        파일 선택
                    </label>
                    <input type="file" id="auth-file-upload" style="display: none;" multiple
                        onchange="handleAuthFileSelect(event)">

                    <div class="file-list-container" id="auth-file-list-area">
                        <div class="file-list-header">
                            <span class="total-count" id="auth-file-total-count">총 0개</span>
                            <span class="total-size" id="auth-file-total-size">0KB/1GB</span>
                        </div>
                        <div id="auth-file-list-items">
                        </div>
                    </div>

                    <p class="disclaimer" style="margin-top: 12px;">* 최대 4GB 크기의 PDF(권장), ai, psd, cdr, jpg, gif, png
                        형식의 파일을 첨부할 수 있어요</p>
                    <p class="disclaimer">* 2건 이상 접수 시, 파일명에 구분 가능한 내용과 건수를 포함해주세요 (ex) 명함_앞면_CMYK)</p>
                </div>

            </div>
            <div class="modal-footer-full">
                <button class="dark-button" onclick="alert('별도견적 신청 완료 (회원)')">별도견적 신청</button>
            </div>
        </div>
    </div>


    <div class="modal-overlay" id="unauth-quote-apply-modal-overlay">
        <div class="full-modal-content" id="unauth-quote-apply-modal">
            <header class="modal-header-full">
                <h1 class="modal-title-full">별도견적 신청</h1>
                <button type="button" class="btn-modal-close-full"
                    onclick="closeModal('unauth-quote-apply-modal-overlay')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M18 6l-12 12" />
                        <path d="M6 6l12 12" />
                    </svg>
                </button>
            </header>
            <div class="modal-body-full" id="unauth-quote-modal">
                <div class="form-group">
                    <label>선택 옵션</label>
                    <div class="input input-read-only"
                        style="flex-direction: column; align-items: flex-start; justify-content: flex-start; min-height: 70px; padding: 12px;">
                        <span class="product-name">책자</span>
                        <ul class="product-options" style="list-style: disc; padding-left: 0;">
                            <li>용지: (표지)아트지/백색/ 100g, (내지) 아트지/백색/100g</li>
                            <li>인쇄: (표지) 양면 / CMYK / 일반, (내지) 단면/K/일반</li>
                            <li>사이즈: A4(210×195mm)</li>
                            <li>가공: 박/오시/도무송</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group">
                    <label for="unauth-quote-detail">견적 요청 상세</label>
                    <div class="input" style="align-items: flex-start; min-height: 120px;">
                        <textarea id="unauth-quote-detail"
                            placeholder="원하시는 옵션과 요청사항을 가능한 자세히 입력해주세요 (ex. 특수 용지 사용, 대량 인쇄(10,000,000매) 등)"></textarea>
                    </div>
                    <div class="disclaimer">0/1,000</div>
                </div>

                <div class="form-group" style="padding-top: 5px;">
                    <label style="font-weight: 700; font-size: 16px;">신청자 정보</label>

                    <div class="form-group" style="margin-bottom: 12px;">
                        <label for="unauth-name">이름</label>
                        <div class="input">
                            <input type="text" id="unauth-name" placeholder="이름을 입력해주세요">
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom: 12px;">
                        <label for="unauth-contact">연락처</label>
                        <div class="input-group">
                            <div class="combobox-wrapper combobox-wrapper-small">
                                <div class="input select-wrapper" onclick="showCountryCodeDropdown('unauth')"
                                    onfocus="showCountryCodeDropdown('unauth')"
                                    onblur="hideCountryCodeDropdown('unauth')" tabindex="0">
                                    <span class="select-flag" id="unauth-country-code-flag"></span>
                                    <input type="text" id="unauth-country-code-display" value="+82" readonly>
                                </div>
                                <div class="combobox-dropdown" id="unauth-country-code-dropdown">
                                    <div class="combobox-item"
                                        onmousedown="selectCountryCode('unauth', 'assets/images/flag-kor.png', '+82', 'Korean flag')">
                                        <span class="flag"><img src="assets/images/flag-kor.png"
                                                alt="Korean flag"></span> <strong>+82</strong>
                                    </div>
                                    <div class="combobox-item"
                                        onmousedown="selectCountryCode('unauth', 'assets/images/flag-jp.png', '+81', 'Japanese flag')">
                                        <span class="flag"><img src="assets/images/flag-jp.png"
                                                alt="Japanese flag"></span> <strong>+81</strong>
                                    </div>
                                    <div class="combobox-item"
                                        onmousedown="selectCountryCode('unauth', 'assets/images/flag-eng.png', '+1', 'USA flag')">
                                        <span class="flag"><img src="assets/images/flag-eng.png" alt="USA flag"></span>
                                        <strong>+1</strong>
                                    </div>
                                </div>
                            </div>
                            <div class="input">
                                <input type="tel" id="unauth-contact-number" placeholder="'-'없이 숫자만 입력해주세요">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="unauth-email">이메일 주소</label>
                        <div class="combobox-wrapper">
                            <div class="input">
                                <input type="email" placeholder="이메일 주소를 입력해주세요" autocomplete="off"
                                    oninput="filterEmailSuggestions(this)" onfocus="filterEmailSuggestions(this)"
                                    onblur="hideEmailDropdown(this)">
                            </div>
                            <div class="combobox-dropdown"></div>
                        </div>
                        <p class="disclaimer">* 별도견적 시 확인 필요사항이 있을 경우 연락 가능한 휴대폰 번호를 입력해주세요</p>
                    </div>
                </div>

                <div class="form-group" style="padding-bottom: 10px; margin-bottom: 20px;">
                    <label style="margin-bottom: 12px;">파일 업로드(선택)</label>

                    <label for="unauth-file-upload" class="white-button file-upload-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                            <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                            <path d="M12 11v6" />
                            <path d="M9 14l3 -3l3 3" />
                        </svg>
                        파일 선택
                    </label>
                    <input type="file" id="unauth-file-upload" style="display: none;" multiple
                        onchange="handleUnauthFileSelect(event)">

                    <div class="file-list-container" id="unauth-file-list-area">
                        <div class="file-list-header">
                            <span class="total-count" id="unauth-file-total-count">총 0개</span>
                            <span class="total-size" id="unauth-file-total-size">0KB/1GB</span>
                        </div>
                        <div id="unauth-file-list-items">
                        </div>
                    </div>

                    <p class="disclaimer" style="margin-top: 12px;">* 최대 4GB 크기의 PDF(권장), ai, psd, cdr, jpg, gif, png
                        형식의 파일을 첨부할 수 있어요</p>
                </div>

            </div>
            <div class="modal-footer-full">
                <button class="dark-button" onclick="alert('별도견적 신청 완료 (비회원)')">별도견적 신청</button>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // Modal Helpers (Full Modal)
        // ========================================
        function openModal(overlayId) {
            const overlay = document.getElementById(overlayId);
            if (overlay) {
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(overlayId) {
            const overlay = document.getElementById(overlayId);
            if (overlay) {
                const modalContent = overlay.querySelector('.full-modal-content');
                if (modalContent) {
                    modalContent.style.animation = 'slideOutDown 0.3s ease-in';
                }

                setTimeout(() => {
                    overlay.classList.remove('active');
                    if (modalContent) {
                        modalContent.style.animation = '';
                    }
                    const anyModalActive = document.querySelector('.modal-overlay.active:not(#quote-select-modal-overlay):not(#auth-quote-apply-modal-overlay):not(#unauth-quote-apply-modal-overlay)');
                    if (!anyModalActive) {
                        document.body.style.overflow = '';
                    }
                }, 300);
            }
        }

        const styleElement = document.createElement('style');
        styleElement.textContent = `
            @keyframes slideOutDown {
                from { transform: translateY(0); }
                to { transform: translateY(100%); }
            }
        `;
        document.head.appendChild(styleElement);


        // ========================================
        // 견적 선택 모달 로직
        // ========================================
        const maxSelection = 2;

        function getCheckedCount() {
            return document.querySelectorAll('#quote-list-container .common-table-card.selected').length;
        }

        function updateQuoteSelectionButton() {
            const selectedCount = getCheckedCount();
            const completeBtn = document.getElementById('quote-select-complete-btn');

            if (completeBtn) {
                if (selectedCount > 0) {
                    completeBtn.disabled = false;
                    completeBtn.textContent = `선택 완료 (${selectedCount}개)`;
                } else {
                    completeBtn.disabled = true;
                    completeBtn.textContent = `선택 완료`;
                }
            }
        }

        function toggleV12Checkbox(checkbox) {
            const isChecked = checkbox.dataset.checked === 'true';
            const newState = !isChecked;
            checkbox.dataset.checked = newState;
            const checkedImg = 'assets/images/checked.svg';
            checkbox.innerHTML = newState ? `<div class="checkbox-on"><img src="${checkedImg}" alt="체크"></div>` : '<div class="checkbox-off"></div>';
            return newState;
        }

        function toggleQuoteSelection(card) {
            const checkboxWrapper = card.querySelector('.checkbox-text-wrapper');
            const checkbox = checkboxWrapper.querySelector('.checkbox');
            const isSelected = card.classList.contains('selected');
            const selectedCount = getCheckedCount();

            let newState = false;

            if (isSelected) {
                card.classList.remove('selected');
                newState = toggleV12Checkbox(checkbox);
            } else if (selectedCount < maxSelection) {
                card.classList.add('selected');
                newState = toggleV12Checkbox(checkbox);
            } else {
                alert(`견적은 최대 ${maxSelection}개까지 선택 가능합니다.`);
                return;
            }
            updateQuoteSelectionButton();
        }

        function handleQuoteSelectComplete() {
            const selectedQuotes = Array.from(document.querySelectorAll('#quote-list-container .common-table-card.selected'))
                .map(card => card.dataset.quoteId);
            if (selectedQuotes.length === 0) {
                alert("비교할 견적을 1개 이상 선택해주세요.");
                return;
            }
            alert(`선택 완료: ${selectedQuotes.join(', ')}번 견적 (${selectedQuotes.length}개)`);
            closeModal('quote-select-modal-overlay');
        }

        // ========================================
        // [New] File Upload Logic (Auth/Unauth)
        // ========================================

        let authFileList = [];
        let unauthFileList = [];

        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + " " + sizes[i];
        }

        function updateFileUI(type) {
            const list = type === 'auth' ? authFileList : unauthFileList;
            const containerId = type === 'auth' ? 'auth-file-list-area' : 'unauth-file-list-area';
            const itemsId = type === 'auth' ? 'auth-file-list-items' : 'unauth-file-list-items';
            const countId = type === 'auth' ? 'auth-file-total-count' : 'unauth-file-total-count';
            const sizeId = type === 'auth' ? 'auth-file-total-size' : 'unauth-file-total-size';

            const container = document.getElementById(containerId);
            const itemsContainer = document.getElementById(itemsId);

            if (list.length === 0) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';
            itemsContainer.innerHTML = '';

            let totalSize = 0;

            list.forEach((file, index) => {
                totalSize += file.size;
                const div = document.createElement('div');
                div.className = 'file-item';
                div.innerHTML = `
                    <span class="file-name">${file.name}</span>
                    <span class="file-size">${formatBytes(file.size)}</span>
                    <button type="button" class="remove-btn" onclick="removeQuoteFile('${type}', ${index})">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>
                    </button>
                `;
                itemsContainer.appendChild(div);
            });

            document.getElementById(countId).textContent = `총 ${list.length}개`;
            document.getElementById(sizeId).textContent = `${formatBytes(totalSize)}/1GB`;
        }

        function handleAuthFileSelect(event) {
            const files = Array.from(event.target.files);
            if (!files.length) return;
            files.forEach(file => {
                if (!authFileList.some(f => f.name === file.name)) {
                    authFileList.push(file);
                }
            });
            updateFileUI('auth');
            event.target.value = null;
        }

        function handleUnauthFileSelect(event) {
            const files = Array.from(event.target.files);
            if (!files.length) return;
            files.forEach(file => {
                if (!unauthFileList.some(f => f.name === file.name)) {
                    unauthFileList.push(file);
                }
            });
            updateFileUI('unauth');
            event.target.value = null;
        }

        function removeQuoteFile(type, index) {
            if (type === 'auth') {
                authFileList.splice(index, 1);
                updateFileUI('auth');
            } else {
                unauthFileList.splice(index, 1);
                updateFileUI('unauth');
            }
        }

        // ========================================
        // Country Code Combobox
        // ========================================

        let activeCountryDropdownId = null;

        function showCountryCodeDropdown(context) {
            const dropdownId = context === 'unauth' ? 'unauth-country-code-dropdown' : 'country-code-dropdown';
            const dropdown = document.getElementById(dropdownId);

            const isHidden = dropdown.style.display === 'none' || dropdown.style.display === '';

            document.querySelectorAll('.combobox-dropdown').forEach(d => { d.style.display = 'none'; });

            if (isHidden) {
                activeCountryDropdownId = dropdownId;
                if (dropdown) dropdown.style.display = 'block';
            }
        }

        function hideCountryCodeDropdown(context) {
            const dropdownId = context === 'unauth' ? 'unauth-country-code-dropdown' : 'country-code-dropdown';
            const dropdown = document.getElementById(dropdownId);
            setTimeout(() => {
                if (dropdown) dropdown.style.display = 'none';
                activeCountryDropdownId = null;
            }, 200);
        }

        function selectCountryCode(context, flagImgSrc, codeText, altText) {
            const flagId = context === 'unauth' ? 'unauth-country-code-flag' : 'country-code-flag';
            const displayId = context === 'unauth' ? 'unauth-country-code-display' : 'country-code-display';

            document.getElementById(flagId).innerHTML = `<img src="${flagImgSrc}" alt="${altText}">`;
            document.getElementById(displayId).value = codeText;

            setTimeout(() => {
                const blurElement = document.getElementById(displayId);
                if (blurElement) blurElement.blur();
                hideCountryCodeDropdown(context);
            }, 50);
        }

        document.addEventListener('click', (e) => {
            document.querySelectorAll('.combobox-dropdown').forEach(dropdown => {
                const wrapper = dropdown.closest('.combobox-wrapper');
                if (dropdown.style.display === 'block' && wrapper && !wrapper.contains(e.target)) {
                    dropdown.style.display = 'none';
                    activeCountryDropdownId = null;
                }
            });
        });

        /* --- 이메일 자동완성 로직 시작 --- */

        // 1. 추천할 도메인 리스트 (필요시 추가/수정 가능)
        const emailDomains = ['naver.com', 'gmail.com', 'daum.net', 'hanmail.net', 'nate.com'];

        // 2. 입력 감지 및 필터링 함수
        function filterEmailSuggestions(input) {
            const value = input.value;
            const wrapper = input.closest('.combobox-wrapper');
            const dropdown = wrapper.querySelector('.combobox-dropdown');

            dropdown.innerHTML = ''; // 기존 목록 초기화

            // 입력값이 없으면 숨김
            if (value.length === 0) {
                dropdown.style.display = 'none';
                return;
            }

            const atIndex = value.indexOf('@');
            let localPart = value;
            let domainPart = '';

            // @ 입력 여부에 따라 아이디/도메인 분리
            if (atIndex > -1) {
                localPart = value.substring(0, atIndex);
                domainPart = value.substring(atIndex + 1);
            }

            // @로 시작하거나 아이디가 없으면 숨김
            if (localPart.length === 0) {
                dropdown.style.display = 'none';
                return;
            }

            // 도메인 매칭 (입력된 도메인 부분으로 필터링)
            const matchingDomains = emailDomains.filter(domain => domain.startsWith(domainPart));

            // 매칭되는 도메인이 있으면 목록 생성
            if (matchingDomains.length > 0) {
                matchingDomains.forEach(domain => {
                    const fullEmail = localPart + '@' + domain;

                    const item = document.createElement('div');
                    item.className = 'combobox-item';
                    item.textContent = fullEmail;

                    // 클릭 시 선택 (onmousedown 사용: blur보다 먼저 실행되게 함)
                    item.onmousedown = function () {
                        selectEmailSuggestion(fullEmail, input, dropdown);
                    };

                    dropdown.appendChild(item);
                });
                dropdown.style.display = 'block';
            } else {
                dropdown.style.display = 'none';
            }
        }

        // 3. 선택 시 값 적용 함수
        function selectEmailSuggestion(fullEmail, inputElement, dropdownElement) {
            inputElement.value = fullEmail; // 값 적용
            dropdownElement.style.display = 'none'; // 드롭다운 숨김

            // (선택 사항) 값 변경 이벤트 트리거 (유효성 검사 등이 연결된 경우 필요)
            inputElement.dispatchEvent(new Event('input'));
        }

        // 4. 포커스 해제 시 숨김 함수
        function hideEmailDropdown(input) {
            const wrapper = input.closest('.combobox-wrapper');
            const dropdown = wrapper.querySelector('.combobox-dropdown');

            // 바로 사라지면 클릭이 안될 수 있으므로 약간의 지연 시간 부여
            setTimeout(() => {
                if (dropdown) dropdown.style.display = 'none';
            }, 200);
        }
        /* --- 이메일 자동완성 로직 끝 --- */

        // --- Initialize ---
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('#quote-list-container .common-table-card.selected').forEach(card => {
                const checkbox = card.querySelector('.checkbox');
                if (checkbox.dataset.checked !== 'true') {
                    toggleV12Checkbox(checkbox);
                }
            });
            updateQuoteSelectionButton();

            const unauthFlag = document.getElementById('unauth-country-code-flag');
            if (unauthFlag) {
                unauthFlag.innerHTML = `<img src="assets/images/flag-kor.png" alt="Korean flag">`;
            }
        });

    </script>
</body>

</html>