<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>성원애드피아 - 문의 수정</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* [v12] Master Guide CSS */
        /* Reset & Base */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html, body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f5f7; color: #333; font-size: 16px; line-height: 1.6; overflow-x: visible;
        }
        ul, li { list-style: none; }
        a { text-decoration: none; color: inherit; }
        button { font-family: inherit; border: none; cursor: pointer; background: none; padding: 0; }
        img { max-width: 100%; max-height: 100%; object-fit: contain; display: block; }
        input, select, textarea { font-family: inherit; }
        svg { stroke-width: 2; fill: none; stroke: currentColor; stroke-linecap: round; stroke-linejoin: round; flex-shrink: 0; display: block; }

        /* Layout */
        .mobile-wrap { 
            width: 100%; 
            max-width: 480px; 
            margin: 0 auto; 
            background-color: #ffffff; 
            padding-bottom: 100px; /* Sticky Footer 여백 */
        }

        /* Header (v12 Standard) */
        .app-header-sub { height: 56px; background: white; border-bottom: 1px solid #cccccc; display: flex; align-items: center; justify-content: space-between; padding: 0 16px; position: sticky; top: 0; z-index: 100; }
        .header-btn { display: flex; align-items: center; justify-content: center; width: 28px; height: 28px; cursor: pointer; transition: transform 0.2s; color: #333; }
        .header-btn:active { transform: scale(0.9); }
        .header-left { flex: 1 0 0; display: flex; justify-content: flex-start; }
        .header-title { 
            flex: 3 0 0; 
            font-size: 18px; 
            font-weight: 600; 
            text-align: center; 
            color: #212121; 
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .header-right { flex: 1 0 0; display: flex; justify-content: flex-end; gap: 8px; }
        .btn-icon { cursor: pointer; transition: transform 0.2s; display: flex; align-items: center; justify-content: center; flex-shrink: 0; width: 24px; height: 24px; color: #333; }
        .btn-icon:active { transform: scale(0.9); }
        .btn-icon svg { width: 100%; height: 100%; }

        /* Buttons (v12 Standard + Primary) */
        .primary-button { background-color: #4e6ee4; color: white; height: 44px; padding: 7px 19px; border-radius: 6px; border: none; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; min-width: fit-content; }
        .primary-button:hover { background: #3d5dd3; }
        .primary-button:active { transform: scale(0.98); }
        .dark-button { background: #424242; color: white; height: 44px; padding: 7px 19px; border-radius: 6px; border: none; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; min-width: fit-content; }
        .dark-button:hover { background: #333; }
        .dark-button:active { transform: scale(0.98); }
        .white-button { background: white; color: #424242; height: 44px; padding: 7px 19px; border-radius: 6px; border: 1px solid #e8e8e9; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; min-width: fit-content; }
        .white-button:hover { background: #f9f9f9; }
        .white-button:active { transform: scale(0.98); }
        .dark-button:disabled,
        .white-button:disabled,
        .primary-button:disabled {
            background-color: #e9ecef;
            color: #adb5bd;
            border-color: #e9ecef;
            cursor: not-allowed;
        }
        
        /* Main Content */
        .sw-container { padding: 16px; }

        /* [MODIFIED] Filter Chip Section Grouping */
        .inquiry-type-section {
            background: #fff;
            border-bottom: 8px solid #f4f5f7; /* [NEW] Thick divider */
        }
        .filter-chip-group {
            padding: 16px;
        }
        .sub-category-group {
            padding: 0 16px 16px 16px;
        }

        .tabs-scroll-wrapper {
            overflow-x: auto;
            white-space: nowrap;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .tabs-scroll-wrapper::-webkit-scrollbar { display: none; }
        .filter-chip-group .tabs-scroll-wrapper {
            display: flex; 
            gap: 8px; 
        }
        .filter-chip-group .single-chip {
            flex-shrink: 0; 
            white-space: nowrap; 
        }
        
        /* [NEW] Disabled chip state for Edit */
        .tabs-scroll-wrapper.disabled {
            pointer-events: none;
            opacity: 0.8;
        }
        .tabs-scroll-wrapper.disabled .single-chip {
            cursor: not-allowed;
        }
        
        /* v12 Standard .single-chip */
        .single-chip { display: inline-flex; align-items: center; justify-content: center; padding: 6px 12px; border-radius: 100px; font-size: 14px; cursor: pointer; transition: all 0.2s; user-select: none; }
        .single-chip-off { background: #f5f5f6; color: #8a8a92; }
        .single-chip-on { background: #4e6ee4; color: white; }
        .single-chip:active { transform: scale(0.95); }
        
        /* v12 standard filter-group-content */
        .filter-group-content {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        /* [NEW] v12 standard disclaimer */
        .disclaimer { font-size: 12px; color: #888; margin-top: 8px; line-height: 1.5; }
        
        /* Form Styles (from sungwon_money_01.html / v12 guide) */
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        .readonly-value {
            font-size: 14px;
            color: #333;
            padding: 10px 12px;
            background: #f5f5f5;
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            min-height: 40px;
            display: flex;
            align-items: center;
        }
        .input {
            width: 100%;
            min-height: 40px;
            background: white;
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            padding: 10px 12px;
            display: flex;
            align-items: center;
        }
        .input input {
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            font-size: 14px;
            color: black;
            line-height: 1.5;
        }
        .input input::placeholder { color: #c6c6c8; }
        
        /* [NEW] Input Group (from sungwon_money_01(default).html) */
        .input-group {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .input-group .white-button {
            flex-shrink: 0;
            height: 40px; /* Match input height */
            font-size: 13px;
            padding: 0 12px;
            width: auto;
        }
        
        /* [NEW] Textarea (from sungwon_money_01.html) */
        .input textarea {
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            font-size: 14px;
            color: black;
            line-height: 1.5;
            resize: vertical;
            min-height: 100px; /* Base height */
        }
        .input textarea::placeholder { color: #c6c6c8; }
        
        /* [NEW] Select Box Styling (v12 compliant) */
        .input.select-wrapper {
            padding: 0; /* Remove padding to allow select to fill */
            position: relative;
        }
        .input select {
            width: 100%;
            height: 38px; /* 40px - 2px border */
            border: none;
            outline: none;
            background: transparent;
            font-size: 14px;
            color: black;
            padding: 0 12px;
            appearance: none;
            -webkit-appearance: none;
            background-color: white;
            border-radius: 6px;
            cursor: pointer;
        }
        .input.select-wrapper::after {
            content: '';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23555' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6l6 -6' /%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
            pointer-events: none;
        }
        
        /* [MODIFIED] Info Banner (for AS) */
        .info-banner-container {
            background: #eef2ff; /* Light blue */
            border: 1px solid #c7d3ff; /* Blue border */
            border-radius: 6px;
            margin-bottom: 24px;
            overflow: hidden; /* To keep radius */
        }
        .info-banner-clickable {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            font-size: 13px;
            font-weight: 500;
            color: #3d5dd3;
            cursor: pointer;
        }
        .info-banner-clickable:hover {
            background-color: #e6edff;
        }
        .info-banner-clickable svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            stroke-width: 2.5;
        }
        .info-banner-footer {
            background: #f8f9ff;
            border-top: 1px solid #c7d3ff;
            padding: 10px 16px;
        }
        .info-banner-footer .checkbox-text {
            margin: 0;
        }

        /* [NEW] FAQ List */
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            margin-top: 24px; /* Space between form groups */
        }
        .faq-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 24px;
        }
        .faq-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #f8f8f9;
            border: 1px solid #f0f0f0;
            border-radius: 6px;
            font-size: 14px;
            color: #333;
            font-weight: 500;
            line-height: 1.4;
            cursor: pointer;
        }
        .faq-item:hover { background-color: #f1f1f1; }
        .faq-item span { flex: 1; }
        .faq-item svg {
            width: 16px;
            height: 16px;
            color: #888;
            flex-shrink: 0;
            margin-left: 8px;
        }

        /* [NEW] v12 Checkbox (from Master Guide) */
        .checkbox {
            width: 20px;
            height: 20px;
            position: relative;
            cursor: pointer;
            user-select: none;
            flex-shrink: 0;
        }
        .checkbox-off { width: 100%; height: 100%; background: white; border: 1px solid #bdbdbd; border-radius: 2px; }
        .checkbox-on {
            width: 100%; height: 100%; background: #4e6ee4;
            border-radius: 2px; display: flex;
            align-items: center; justify-content: center;
        }
        .checkbox-on img { width: 14px; height: 14px; }
        .checkbox:active { transform: scale(0.9); }
        .checkbox-text {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
        }
        .checkbox-text span {
            font-size: 14px;
            color: #333;
        }
        
        /* [NEW] Checkbox '자세히 보기' link */
        .disclaimer-link {
            font-size: 13px;
            color: #888;
            text-decoration: underline;
            margin-left: 28px; /* Align with checkbox text */
            margin-top: 4px;
            display: inline-block;
            cursor: pointer;
        }
        
        /* [NEW] Existing File List (for Edit) */
        .existing-file-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }
        .existing-file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: #f8f8f9;
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            font-size: 14px;
            color: #333;
        }
        .existing-file-item span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding-right: 10px;
        }
        .remove-file-btn {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            border-radius: 50%;
            transition: background 0.2s;
        }
        .remove-file-btn:hover {
            background: #e0e0e0;
            color: #333;
        }
        .remove-file-btn svg { width: 14px; height: 14px; stroke-width: 2.5; }
        
        /* [NEW] Sticky Form Footer (from tax_request_write...) */
        .sticky-form-footer {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px; /* Match .mobile-wrap */
            background: #ffffff;
            border-top: 1px solid #e0e0e0;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.05);
            padding: 20px;
            display: flex;
            gap: 8px;
            align-items: center;
            justify-content: space-between;
            z-index: 500;
        }
        .sticky-form-footer .btn {
            flex: 1;
        }
        .sticky-form-footer .white-button {
             flex-grow: 1;
        }
         .sticky-form-footer .dark-button {
             flex-grow: 2; /* 등록하기 버튼을 더 크게 */
        }
        
        /* ========================================
           [NEW] MODAL STYLES (v12 Standard)
        ======================================== */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 16px;
            animation: fadeInModal 0.2s ease-out;
        }
        .modal-overlay.active { display: flex; }
        @keyframes fadeInModal {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .modal-content {
            background: white;
            border-radius: 8px;
            width: 100%;
            max-width: 360px; /* Modal max width */
            max-height: 90vh; /* Limit height */
            display: flex;
            flex-direction: column;
            animation: scaleUpModal 0.2s ease-out;
        }
        @keyframes scaleUpModal {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #e8e8e9;
            position: relative; /* For close button */
            height: 57px; /* Match v12 modal header */
        }
        .modal-title {
            font-size: 16px;
            font-weight: 700;
            color: black;
            text-align: left; 
        }
        .btn-modal-close {
            width: 24px;
            height: 24px;
            cursor: pointer;
            color: #333; /* v12 guide color */
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
        }
        .btn-modal-close:hover { color: #000; }
        .btn-modal-close svg { width: 100%; height: 100%; }
        .modal-body {
            padding: 16px;
            overflow-y: auto;
            flex-grow: 1;
        }
        .modal-footer {
            padding: 16px;
            border-top: 1px solid #e8e8e9;
            background: #fff;
            display: flex;
            gap: 8px;
            border-radius: 0 0 7px 7px;
        }
        .modal-footer .btn {
            flex: 1;
            height: 44px;
            font-size: 14px;
        }
        
        /* [NEW] Alert Modal Specifics (from v12 guide) */
        .alert-modal {
            padding: 20px;
            text-align: center;
        }
        .alert-modal .modal-title {
            text-align: center;
            margin-bottom: 15px;
        }
        .alert-modal .modal-message {
            font-size: 14px;
            color: black;
            margin-bottom: 30px;
            line-height: 1.5;
        }
        .alert-modal .modal-buttons { display: flex; gap: 10px; justify-content: center; }
        .alert-modal .modal-button {
            flex: 1;
            height: 44px;
            padding: 7px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .alert-modal .modal-button-primary { background: #424242; color: white; border: none; }
        .alert-modal .modal-button-secondary { background: white; color: #424242; border: 1px solid #e8e8e9; }
        .alert-modal .modal-button:active { transform: scale(0.98); }
        
        /* [NEW] Search (from v12 Master Guide) */
        .search {
            width: 100%;
            height: 40px;
            background: #f9f9f9;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            position: relative;
        }
        .search input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            font-size: 14px;
            color: black;
        }
        .search input::placeholder { color: #c6c6c8; }
        .search-input-right { display: flex; gap: 3px; align-items: center; }
        .search-del { width: 18px; height: 18px; cursor: pointer; display: none; }
        .search.has-text .search-del { display: flex; }
        .search-icon, .btn-search { width: 24px; height: 24px; cursor: pointer; transition: transform 0.2s; }
        .search-icon:active, .btn-search:active { transform: scale(0.9); }
        .search-del img, .btn-search img, .search-icon img { width: 100%; height: 100%; }
        
        /* [NEW] Modal List Header */
        .transaction-list-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding-bottom: 12px; 
            font-size: 14px; 
            color: #555; 
            border-bottom: 1px solid #e8e8e9; 
            margin-bottom: 12px; 
            margin-top: 16px;
        }
        .transaction-list-header .total-count strong { font-weight: 600; color: #333; }

        /* [NEW] Order List (Modal) */
        .order-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 40vh; /* Set max height for scrolling */
            overflow-y: auto;
        }
        .order-item {
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            padding: 12px;
        }
        .order-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .order-id {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }
        .order-item .white-button {
            height: 32px;
            font-size: 13px;
            padding: 0 12px;
            flex-shrink: 0;
        }
        .order-detail {
            font-size: 13px;
            color: #555;
            margin-bottom: 4px;
            line-height: 1.5;
            word-break: keep-all; 
        }
        
        /* [NEW] Combobox Dropdown */
        .combobox-wrapper {
            position: relative;
            flex: 1;
        }
        .combobox-dropdown {
            position: absolute;
            top: calc(100% + 2px); /* Position below the input */
            left: 0;
            right: 0;
            background: #fff;
            border: 1px solid #e8e8e9;
            border-radius: 6px;
            z-index: 100;
            max-height: 220px;
            overflow-y: auto;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .combobox-item {
            padding: 10px 12px;
            font-size: 14px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
        }
        .combobox-item:last-child {
            border-bottom: none;
        }
        .combobox-item:hover {
            background: #f5f5f6;
        }
        .combobox-item strong {
            font-weight: 600;
            color: #333;
        }
        .combobox-item .order-date {
            font-size: 12px;
            color: #888;
            margin-left: 8px;
        }
        
        
        /* ========================================
           [NEW] BOTTOM SHEET STYLES (v12 Standard)
        ======================================== */
        .bottom-sheet-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: flex-end;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.2s ease-out;
        }
        .bottom-sheet-overlay.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes slideDown { from { transform: translateY(0); } to { transform: translateY(100%); } }

        .bottom-sheet {
            width: 100%;
            max-width: 480px;
            background: white;
            border-top: 1px solid #d7d7d7;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            position: relative;
            animation: slideUp 0.3s ease-out;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }
        .bottom-sheet.closing { animation: slideDown 0.3s ease-out; }
        .sheet-handle { width: 27px; height: 4px; background: #d9d9d9; border-radius: 100px; margin: 10px auto; cursor: grab; }
        .sheet-handle:active { cursor: grabbing; }
        .sheet-header {
            height: 21px;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-bottom: 20px;
            flex-shrink: 0;
        }
        .sheet-title { font-size: 16px; font-weight: 700; color: black; }
        .btn-close {
            position: absolute;
            right: 20px;
            top: 0;
            width: 21px;
            height: 21px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .btn-close:active { transform: scale(0.9); }
        .btn-close svg { width: 100%; height: 100%; color: #333; }
        .sheet-body {
            flex: 1;
            overflow-y: auto;
            padding: 0 20px 20px 20px;
        }
        .sheet-footer {
            padding: 20px;
            border-top: 1px solid #f0f0f0;
            background: #fff;
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }
        .sheet-footer .btn { flex: 1; }
        
        /* [NEW] AS Policy Sheet Content */
        .as-policy-content { padding: 0 4px; }
        .as-policy-content h3 {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-top: 24px;
            margin-bottom: 12px;
        }
        .as-policy-content h3:first-child { margin-top: 0; }
        .as-policy-content p, .as-policy-content li {
            font-size: 14px;
            color: #555;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        .as-policy-content ul {
            list-style-type: disc;
            margin-bottom: 8px;
        }
        .as-policy-content .highlight {
            color: #dc3545;
            font-weight: 500;
        }
        /* [MODIFIED] AS Policy Footer */
        #as-policy-sheet .sheet-footer {
            justify-content: center; /* Center the single button */
        }
        
        /* [NEW] FAQ Answer Sheet Content */
        .faq-q {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            line-height: 1.5;
            margin-bottom: 16px;
        }
        .faq-a {
            font-size: 14px;
            color: #555;
            line-height: 1.6;
        }

    </style>
</head>
<body>
    <div class="mobile-wrap">
        
        <header class="app-header-sub">
            <div class="header-left">
                <button type="button" class="header-btn" onclick="checkBeforeExit()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="icon-chevron-left"><path d="M15 6l-6 6l6 6" /></svg>
                </button>
            </div>
            <h1 class="header-title">문의 수정</h1>
            <div class="header-right">
                <button type="button" class="btn-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="icon-search"><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>
                </button>
                <button type="button" class="btn-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="icon-cart"><path d="M6 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M17 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M17 17h-11v-14h-2" /><path d="M6 5l14 1l-1 7h-13" /></svg>
                </button>
            </div>
        </header>

        <main>
            <div class="inquiry-type-section">
                <div class="filter-chip-group">
                    <label style="font-size: 14px; font-weight: 600; color: #333; margin-bottom: 8px; display: block;">문의유형</label>
                    <div class="tabs-scroll-wrapper disabled" id="inquiry-type-chips">
                        <div class="single-chip single-chip-on" data-type="AS" onclick="selectInquiryType(this, 'AS')">AS</div>
                        </div>
                </div>
                
                <div class="sub-category-group" id="sub-category-container">
                    <div class="form-group" data-sub-category-for="AS" style="display: none; margin-bottom: 0;">
                        <div class="input select-wrapper">
                            <select id="sub-category-select-as" onchange="isFormDirty = true;">
                                </select>
                        </div>
                    </div>
                    <div class="form-group" data-sub-category-for="DEFAULT" style="display: block; margin-bottom: 0;">
                        <div class="input select-wrapper">
                            <select id="sub-category-select-default" onchange="isFormDirty = true;">
                                </select>
                        </div>
                    </div>
                    <div class="form-group" data-sub-category-for="QNA" style="display: none; margin-bottom: 0;">
                        <div class="input select-wrapper">
                            <select id="sub-category-select-qna" onchange="isFormDirty = true;">
                                </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sw-container" id="form-container">
                <div class="form-section" data-form-type="AS" style="display: none;">
                    
                    <div class="info-banner-container">
                        <div class="info-banner-clickable" onclick="showAsPolicySheet()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                               <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
                               <path d="M12 9h.01" />
                               <path d="M11 12h1v4h1" />
                            </svg>
                            <span>문의 등록 전, <strong>AS 준수사항</strong>을 꼭 확인해주세요.</span>
                        </div>
                        <div class="info-banner-footer">
                            <div class="checkbox-text" onclick="toggleCheckboxText(this)">
                                <div class="checkbox" data-checked="true" id="as-policy-main-checkbox">
                                    <div class="checkbox-on"><img src="assets/images/checked.svg" alt="체크"></div>
                                </div>
                                <span>AS 준수사항을 확인했습니다.</span>
                            </div>
                        </div>
                    </div>
                    
                    <h2 class="section-title" style="margin-top: 0;">자주 묻는 질문</h2>
                    <div class="faq-list" id="faq-list-as">
                        </div>
                    
                    <div class="form-group">
                        <label>접수번호</label>
                        <div class="input-group">
                            <div class="combobox-wrapper">
                                <div class="input">
                                    <input type="text" id="order-number-as" placeholder="접수번호를 입력해주세요" oninput="filterOrderList(this, 'as')" onfocus="showOrderDropdown('as')" onblur="hideOrderDropdown('as')" autocomplete="off" value="sw654543">
                                </div>
                                <div class="combobox-dropdown" id="order-dropdown-as">
                                    </div>
                            </div>
                            <button class="white-button" onclick="showOrderListModal()">접수 목록</button>
                        </div>
                    </div>
                    <div class="form-group" style="display: block;" id="order-date-group-as">
                        <label>접수일</label>
                        <div class="readonly-value" id="order-date-as">2024-12-30</div>
                    </div>
                </div>
                
                <div class="form-section" data-form-type="DEFAULT" style="display: block;">
                    <h2 class="section-title" style="margin-top: 0;">자주 묻는 질문</h2>
                    <div class="faq-list" id="faq-list-default">
                        </div>

                    <div class="form-group">
                        <label>접수번호 (선택)</label>
                        <div class="input-group">
                            <div class="combobox-wrapper">
                                <div class="input">
                                    <input type="text" id="order-number-default" placeholder="접수번호를 입력해주세요" oninput="filterOrderList(this, 'default')" onfocus="showOrderDropdown('default')" onblur="hideOrderDropdown('default')" autocomplete="off">
                                </div>
                                <div class="combobox-dropdown" id="order-dropdown-default">
                                    </div>
                            </div>
                            <button class="white-button" onclick="showOrderListModal()">접수 목록</button>
                        </div>
                    </div>
                    <div class="form-group" style="display: none;" id="order-date-group-default">
                        <label>접수일</label>
                        <div class="readonly-value" id="order-date-default"></div>
                    </div>
                </div>

                <div class="form-section" data-form-type="QNA" style="display: none;">
                    <div class="form-group">
                        <label>공개 여부</label>
                        <div class="filter-group-content" id="privacy-chips">
                            <div class="single-chip single-chip-on" data-value="public" onclick="selectPrivacy(this)">공개</div>
                            <div class="single-chip single-chip-off" data-value="private" onclick="selectPrivacy(this)">비공개</div>
                        </div>
                    </div>
                </div>

                <div class="form-section" data-form-type="AS DEFAULT QNA">
                    <div class="form-group">
                        <label>이름</label>
                        <div class="input">
                            <input type="text" placeholder="이름을 입력해주세요" value="김성원">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>휴대폰 번호</label>
                        <div class="input">
                            <input type="tel" placeholder="'-' 제외한 숫자만 입력해주세요" value="010-1234-5678">
                        </div>
                        <p class="disclaimer">답변이 작성되면 해당 번호로 알림을 드려요.</p>
                    </div>
                    <div class="form-group">
                        <label>문의내용</label>
                        <div class="input" style="align-items: flex-start;">
                            <textarea placeholder="문의내용을 작성해주세요">안녕하세요. 이번에 주문한 명함 출력물에서 문제가 발생하여 문의드립니다.

첨부된 이미지(프린트 테스트 페이지)에서 보시다시피, 출력물 전체적으로 가로 방향의 줄무늬가 선명하게 나타나고 있습니다. 특히 노란색과 마젠타 색상 부분에서 색상 번짐 현상도 확인됩니다. 

해당 문제는 전체 인쇄물에 공통적으로 나타나고 있으며, 이전에 주문했던 다른 인쇄물에서는 발생하지 않던 현상이라 확인을 요청드립니다. 빠른 조치 부탁드립니다.</textarea>
                        </div>
                    </div>
                </div>
                
                <div class="form-section" data-form-type="AS DEFAULT">
                    <div class="form-group">
                        <label>첨부파일</label>
                        <div class="existing-file-list" id="existing-files">
                            <div class="existing-file-item">
                                <span>print_test_page.jpeg</span>
                                <button type="button" class="remove-file-btn" onclick="removeExistingFile(this)">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>
                                </button>
                            </div>
                            <div class="existing-file-item">
                                <span>damaged_business_cards.jpg</span>
                                <button type="button" class="remove-file-btn" onclick="removeExistingFile(this)">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>
                                </button>
                            </div>
                        </div>
                        <button class="white-button" style="width: 100%; font-weight: 500; justify-content: center;">
                            파일 추가
                        </button>
                        <p class="disclaimer">JPG, PNG, GIF, PDF 파일 업로드 가능하며, 최대 3장까지 등록할 수 있습니다.</p>
                    </div>
                </div>

                <div class="form-section" data-form-type="AS DEFAULT QNA">
                    <div class="checkbox-text" onclick="toggleCheckboxText(this)">
                        <div class="checkbox" data-checked="true" id="privacy-checkbox-main">
                            <div class="checkbox-on"><img src="assets/images/checked.svg" alt="체크"></div>
                        </div>
                        <span>개인정보 수집 및 이용 동의 (필수)</span>
                    </div>
                    <span class="disclaimer-link" onclick="alert('자세히 보기 (구현 필요)')">자세히 보기</span>
                </div>
            </div>
        </main>
        
        <div class="sticky-form-footer">
            <button class="white-button btn" onclick="location.href='qna_list.html'">문의 내역</button>
            <button class="dark-button btn" id="submit-inquiry-btn" onclick="alert('수정하기 (구현 필요)')">수정하기</button>
        </div>
    </div>

    <div class="modal-overlay" id="order-list-modal-overlay">
        <div class="modal-content" id="order-list-modal">
            <div class="modal-header">
                <h2 class="modal-title">접수 목록</h2>
                <button class="btn-modal-close" onclick="closeModal('order-list-modal-overlay')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M18 6l-12 12" /><path d="M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="search" data-name="search" id="order-search">
                    <input type="text" placeholder="접수번호 또는 접수제목, 제품명을 입력해주세요" oninput="handleSearchInput(this)">
                    <div class="search-input-right">
                        <div class="search-del" onclick="clearSearch(this)">
                            <img src="https://www.figma.com/api/mcp/asset/ce4b3b50-ed70-4906-8b96-ef21771ec85d"
                                alt="삭제">
                        </div>
                        <div class="btn-search" onclick="handleSearch(this)">
                            <img src="https://www.figma.com/api/mcp/asset/4af11b15-4228-4024-b0ec-cd703ca89e9f"
                                alt="검색">
                        </div>
                    </div>
                </div>
                
                <div class="transaction-list-header">
                    <span class="total-count">총 <strong>7</strong>개</span>
                </div>
                
                <div class="order-list">
                    <article class="order-item">
                        <div class="order-item-header">
                            <span class="order-id">409056-03</span>
                            <button class="white-button" onclick="selectOrder('409056-03', '2025-08-08')">
                                선택
                            </button>
                        </div>
                        <div class="order-detail">명함 - 임원명함</div>
                        <div class="order-detail" style="color: #888;">접수일 2025-08-08</div>
                        <div class="order-detail" style="color: #888; font-size: 12px;">용지: 아트지 / 백색 / 150g | 인쇄: 양면 / CMYK / 일반 | 규격: 208x154 | 수량: 200매 / 1건 | 가공: 박</div>
                    </article>
                    <article class="order-item">
                        <div class="order-item-header">
                            <span class="order-id">409056-02</span>
                            <button class="white-button" onclick="selectOrder('409056-02', '2025-08-08')">
                                선택
                            </button>
                        </div>
                        <div class="order-detail">전단지 - 삼성SDS전단지</div>
                        <div class="order-detail" style="color: #888;">접수일 2025-08-08</div>
                        <div class="order-detail" style="color: #888; font-size: 12px;">용지: 아트지 / 백색/ 150g | 인쇄: 양면 / CMYK / 일반 | 규격: 208x154 | 수량: 200매 / 1건 | 가공: 박</div>
                    </article>
                    <article class="order-item">
                        <div class="order-item-header">
                            <span class="order-id">409056-01</span>
                            <button class="white-button" onclick="selectOrder('409056-01', '2025-08-07')">
                                선택
                            </button>
                        </div>
                        <div class="order-detail">명함 - SAMPLE</div>
                        <div class="order-detail" style="color: #888;">접수일 2025-08-07</div>
                        <div class="order-detail" style="color: #888; font-size: 12px;">용지: 아트지 / 백색/150g | 인쇄: 양면 / CMYK / 일반 | 규격: 208x154 | 수량: 200매 / 1건 | 가공: 박</div>
                    </article>
                    <article class="order-item">
                        <div class="order-item-header">
                            <span class="order-id">234331-02</span>
                            <button class="white-button" onclick="selectOrder('234331-02', '2025-08-06')">
                                선택
                            </button>
                        </div>
                        <div class="order-detail">대봉투 - 무제</div>
                        <div class="order-detail" style="color: #888;">접수일 2025-08-06</div>
                        <div class="order-detail" style="color: #888; font-size: 12px;">용지: 아트지 / 백색 / 150g | 인쇄: 양면 / CMYK / 일반 | 규격: 208x154 | 수량: 200매 / 1건 | 가공: 박</div>
                    </article>
                    <article class="order-item">
                        <div class="order-item-header">
                            <span class="order-id">234331-01</span>
                            <button class="white-button" onclick="selectOrder('234331-01', '2025-08-06')">
                                선택
                            </button>
                        </div>
                        <div class="order-detail">샤이니명함 - 김길동_명함</div>
                        <div class="order-detail" style="color: #888;">접수일 2025-08-06</div>
                        <div class="order-detail" style="color: #888; font-size: 12px;">용지: 아트지 / 백색/ 150g | 인쇄: 양면 / CMYK / 일반 | 규격: 208x154 | 수량: 200매 / 1건 | 가공: 박</div>
                    </article>
                    <article class="order-item">
                        <div class="order-item-header">
                            <span class="order-id">654564</span>
                            <button class="white-button" onclick="selectOrder('654564', '2025-08-03')">
                                선택
                            </button>
                        </div>
                        <div class="order-detail">초저가전단지 - 초저가_샘플</div>
                        <div class="order-detail" style="color: #888;">접수일 2025-08-03</div>
                        <div class="order-detail" style="color: #888; font-size: 12px;">용지: 아트지/백색/ 150g | 인쇄: 양면 / CMYK / 일반 | 규격: 208x154 | 수량: 200매 / 1건 | 가공: 박</div>
                    </article>
                    <article class="order-item">
                        <div class="order-item-header">
                            <span class="order-id">349783</span>
                            <button class="white-button" onclick="selectOrder('349783', '2025-08-02')">
                                선택
                            </button>
                        </div>
                        <div class="order-detail">명함 - 사원 01_명함</div>
                        <div class="order-detail" style="color: #888;">접수일 2025-08-02</div>
                        <div class="order-detail" style="color: #888; font-size: 12px;">용지: 아트지 / 백색/150g | 인쇄: 양면 / CMYK / 일반 | 규격: 208x154 | 수량: 200매 / 1건 | 가공: 박</div>
                    </article>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="exit-alert-modal">
        <div class="modal-content alert-modal" data-name="Alert">
            <div class="modal-title">안내</div>
            <div class="modal-message">이 페이지를 나가면 수정한 내용이 저장되지 않습니다.<br>나가시겠습니까?</div>
            <div class="modal-buttons">
                <button class="modal-button modal-button-secondary" onclick="closeModal('exit-alert-modal')">계속 수정하기</button>
                <button class="modal-button modal-button-primary" onclick="confirmExit()">나가기</button>
            </div>
        </div>
    </div>
    
    <div class="bottom-sheet-overlay" id="as-policy-sheet-overlay">
        <div class="bottom-sheet" data-name="bottom-sheet" id="as-policy-sheet">
            <div class="sheet-handle" id="as-policy-sheet-handle"></div>
            <div class="sheet-header">
                <div class="sheet-title">AS 준수사항</div>
                <div class="btn-close" onclick="closeAsPolicySheet()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>
                </div>
            </div>
            <div class="sheet-body">
                <div class="as-policy-content">
                    <p style="font-size: 14px; color: #333; margin-bottom: 20px;">문의 등록 전, 아래 내용을 반드시 숙지해주세요.</p>
                    
                    <h3>재작업 및 반품 가능기간</h3>
                    <p><span class="highlight">인쇄물을 수령한 날로부터 7일 이내</span>에만 재작업 요청이 가능합니다.</p>
                    <p>기준일 초과시 재작업이 불가합니다.</p>

                    <h3>회수 기준</h3>
                    <p>재작업을 위해서는 <span class="highlight">하자 있는 인쇄물의 90% 이상</span>이 당사 A/S팀으로 회수되어야 합니다.</p>
                    <p>단, 당사 과실이 명확히 확인된 경우에는 회수 과정이 생략될 수 있습니다.</p>
                    
                    <h3>회수 방법</h3>
                    <ul>
                        <li>재작업 처리는 사고 물건의 90% 이상이 당사로 회수되어야 합니다.</li>
                        <li>월 배송 고객은 월배송을 통해 반송해주시고, 택배/퀵/화물 고객은 <span class="highlight">반드시 지정택배사를 통해 착불로</span> 당사 A/S팀에 반송해야 합니다.</li>
                        <li>사전 연락 없이 지정 택배사 외 다른 방법으로 보낼 경우 반송 처리 됩니다.</li>
                    </ul>

                    <h3>책임 범위</h3>
                    <p>재작업건에 대한 당사의 책임범위는 인쇄물 완성까지입니다.</p>

                    <h3>과실에 따른 부담 비용</h3>
                    <p style="font-weight: 600; color: #333;">당사 과실</p>
                    <p>모든 인쇄물은 하자 검수 없이 배송됩니다. 당사 실수로 재작업하는 경우, 택배나 월배송으로 무상처리해드립니다. 또한 당사의 실수가 확인될 때에는 물건 회수과정이 생략될 수 있습니다.</p>
                    <p style="font-weight: 600; color: #333;">고객 과실</p>
                    <p>재작업 사유가 고객의 실수인 경우, 배송비는 고객부담으로 유상처리 됩니다. 재작업 시 데이터 수정을 원하시면 고객님께서 <span class="highlight">재작업 비용의 50%</span>를 부담해야 합니다.</p>
                    
                    <h3>환불 및 손해배상</h3>
                    <p>환불 및 손해배상에 대한 규정은 당사 이용약관을 따릅니다. 자세한 사항은 고객센터로 문의바랍니다.</p>
                </div>
            </div>
            <div class="sheet-footer">
                <button class="btn dark-button" style="width: 100%;" id="as-policy-confirm-btn" onclick="confirmAsPolicy()">확인</button>
            </div>
        </div>
    </div>
    
    <div class="bottom-sheet-overlay" id="faq-answer-sheet-overlay">
        <div class="bottom-sheet" data-name="bottom-sheet" id="faq-answer-sheet">
            <div class="sheet-handle" id="faq-answer-sheet-handle"></div>
            <div class="sheet-header">
                <div class="sheet-title">자주 묻는 질문</div>
                <div class="btn-close" onclick="closeFaqAnswerSheet()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>
                </div>
            </div>
            <div class="sheet-body">
                <div class="faq-q" id="faq-answer-q"></div>
                <div class="faq-a" id="faq-answer-a"></div>
            </div>
            <div class="sheet-footer">
                <button class="btn dark-button" style="width: 100%;" onclick="closeFaqAnswerSheet()">확인</button>
            </div>
        </div>
    </div>


    <script>
        // --- [NEW] Form Dirty Check & Exit Alert ---
        let isFormDirty = false;
        
        function checkBeforeExit() {
            if (isFormDirty) {
                openModal('exit-alert-modal');
            } else {
                goBack();
            }
        }
        
        function confirmExit() {
            isFormDirty = false; // Reset flag
            closeModal('exit-alert-modal');
            goBack();
        }
        
        function goBack() {
             // Simple history back. In a real app, you might want a more robust routing.
             history.back();
        }

        // --- Modal Helpers (v12 Standard) ---
        function openModal(overlayId) {
            const overlay = document.getElementById(overlayId);
            if (overlay) {
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(overlayId) {
            const overlay = document.getElementById(overlayId);
            if (overlay) {
                overlay.classList.remove('active');
                const anyModalActive = document.querySelector('.modal-overlay.active, .bottom-sheet-overlay.active');
                if (!anyModalActive) {
                    document.body.style.overflow = '';
                }
            }
        }
        
        // --- Bottom Sheet Logic (v12 Standard) ---
        function setupBottomSheet(overlayId, sheetId, handleId) {
            const overlay = document.getElementById(overlayId); 
            const sheet = document.getElementById(sheetId); 
            const handle = document.getElementById(handleId);
            if (!overlay || !sheet || !handle) return { openSheet: ()=>{}, closeSheet: ()=>{} };
            
            let isDragging = false, startY = 0, currentY = 0;
            
            const openSheet = () => { 
                overlay.classList.add('active'); 
                sheet.classList.remove('closing'); 
                document.body.style.overflow = 'hidden'; 
            };
            
            const closeSheet = () => { 
                sheet.classList.add('closing'); 
                const anyModalActive = document.querySelector('.modal-overlay.active');
                if (!anyModalActive) {
                    document.body.style.overflow = ''; 
                }
                setTimeout(() => { 
                    overlay.classList.remove('active'); 
                    sheet.classList.remove('closing'); 
                    sheet.style.transform = ''; // Reset transform
                }, 300); 
            };
            
            const startDrag = (e) => { 
                isDragging = true; 
                startY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY; 
                sheet.style.transition = 'none'; 
            };
            
            const drag = (e) => { 
                if (!isDragging) return; 
                e.preventDefault(); 
                currentY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY; 
                const deltaY = currentY - startY; 
                if (deltaY > 0) sheet.style.transform = `translateY(${deltaY}px)`; 
            };
            
            const endDrag = () => { 
                if (!isDragging) return; 
                isDragging = false; 
                sheet.style.transition = ''; 
                const deltaY = currentY - startY; 
                if (deltaY > 100) closeSheet(); 
                else sheet.style.transform = ''; 
            };
            
            handle.addEventListener('mousedown', startDrag); 
            handle.addEventListener('touchstart', startDrag, { passive: false });
            document.addEventListener('mousemove', drag); 
            document.addEventListener('touchmove', drag, { passive: false });
            document.addEventListener('mouseup', endDrag); 
            document.addEventListener('touchend', endDrag);
            overlay.addEventListener('click', (e) => { if (e.target.id === overlayId) closeSheet(); });
            
            return { openSheet, closeSheet };
        }
        
        const { openSheet: showAsPolicySheet, closeSheet: closeAsPolicySheet } = setupBottomSheet('as-policy-sheet-overlay', 'as-policy-sheet', 'as-policy-sheet-handle');
        const { openSheet: showFaqAnswerSheet, closeSheet: closeFaqAnswerSheet } = setupBottomSheet('faq-answer-sheet-overlay', 'faq-answer-sheet', 'faq-answer-sheet-handle');


        // --- Checkbox (v12 Standard) ---
        function toggleCheckbox(checkbox) {
            const isChecked = checkbox.dataset.checked === 'true';
            let newState;
            if (isChecked) {
                newState = false;
                checkbox.dataset.checked = 'false';
                checkbox.innerHTML = '<div class="checkbox-off"></div>';
            } else {
                newState = true;
                checkbox.dataset.checked = 'true';
                checkbox.innerHTML = `<div class="checkbox-on"><img src="assets/images/checked.svg" alt="체크"></div>`;
            }
            return newState;
        }
        
        function toggleCheckboxText(wrapper) {
            const checkbox = wrapper.querySelector('.checkbox');
            const newState = toggleCheckbox(checkbox);
            
            if (checkbox.id === 'as-policy-main-checkbox' && !newState) {
                // If user unchecks the AS policy, do nothing special
            }
        }
        
        // [NEW] AS Policy Confirmation Logic
        function confirmAsPolicy() {
            const mainCheckbox = document.getElementById('as-policy-main-checkbox');
            if (mainCheckbox.dataset.checked !== 'true') {
                mainCheckbox.dataset.checked = 'true';
                mainCheckbox.innerHTML = `<div class="checkbox-on"><img src="assets/images/checked.svg" alt="체크"></div>`;
                isFormDirty = true; // Mark form as dirty
            }
            closeAsPolicySheet();
        }

        // --- Search (v12 Standard) ---
        function handleSearchInput(input) {
            const searchBox = input.closest('.search');
            searchBox.classList.toggle('has-text', input.value.trim() !== '');
        }
        function clearSearch(btn) {
            const searchBox = btn.closest('.search');
            const input = searchBox.querySelector('input');
            input.value = '';
            searchBox.classList.remove('has-text');
            input.focus();
            
            if (searchBox.id === 'order-search') {
                // [NEW] If clearing modal search, reset list
                // (In a real app, you'd re-fetch or show all)
            }
        }
        function handleSearch(btn) { console.log('Search submitted:', btn.closest('.search').querySelector('input').value); }


        // --- [MODIFIED] Inquiry Form Logic ---

        // [MODIFIED] Data for conditional fields
        const subCategoryOptions = {
            'AS': [
                '미발송', '상담', '오배송', '완제품 이상', '용지/인쇄/재단/가공/포장'
            ],
            'DEFAULT': {
                '출고/배송': ['배송 메모', '배송요금', '배송지 변경', '선불/후불/방문수령/퀵/월배송', '제작현황/출고/납기/픽업 문의'],
                '제작': ['담당직원', '디자인 관련', '별도견적', '사이즈 문의', '색상 문의', '샘플요청', '작업 상세', '작업 수정/취소', '재접수', '제작 여부', '지종 문의', '포장'],
                '고객상담': ['고객의 소리', '자재(입고/성분 등)', '주문자 정보 변경', '추가주문', '홈페이지 불편문의', '회원(기업)가입/정보 수정'],
                '파일접수': ['교정/감리', '별색', '성원 웹하드', '주문 실수/누락/중복', '파일(작업/수정/취소/폰트/템플릿)'],
                '회계관련': ['성원머니(전환/환불 등)', '가상계좌변경', '거래명세서/전표 발급', '서류발급/요청', '세금계산서 관련', '입금확인', '주문(부분)취소 및 환불', '카드 결제/취소', '현금영수증 관련', '환불계좌 등록/변경'],
                '기타': ['기타 문의']
            },
            'QNA': ['명함', '홍보물', '스티커', '패키지/봉투', '서식지', '굿즈']
        };
        
        const faqItems = {
            'AS': [
                { q: 'Q. 제품 용지/인쇄/재단/가공/포장에 문제가 있어요.', a: 'A. AS 접수 시, 문제가 된 제품의 사진이나 상세한 설명을 함께 첨부해주시면 더 빠른 처리가 가능합니다. [AS 준수사항]을 확인해주세요.' },
                { q: 'Q. 공정 담당자를 지정하고 싶어요.', a: 'A. 공정 담당자는 작업 특성 상, 시스템을 통해 접수 순서대로 자동 배정됩니다. 제작 공정 중 요청사항이 있는 경우, 고객센터를 이용하시기 바랍니다.' },
                { q: 'Q. 최종 작업 완료 일정이나 현재 작업 진행상황을 알고싶습니다.', a: 'A. 작업 일정은 마이페이지 > 접수/배송 내역에서 확인하실 수 있습니다. 현재 공정 단계 또한 실시간으로 업데이트되니 참고 부탁드립니다.' }
            ],
            'DEFAULT': [
                { q: 'Q. 공정 담당자를 지정하고 싶어요.', a: 'A. 공정 담당자는 작업 특성 상, 시스템을 통해 접수 순서대로 자동 배정됩니다. 제작 공정 중 요청사항이 있는 경우, 고객센터를 이용하시기 바랍니다.' },
                { q: 'Q. 제품 용지/인쇄/재단/가공/포장에 문제가 있어요.', a: 'A. 제품에 문제가 있는 경우, [AS] 카테고리를 선택하여 문의를 접수해주시기 바랍니다. [AS 준수사항]을 함께 확인해주세요.' },
                { q: 'Q. 최종 작업 완료 일정이나 현재 작업 진행상황을 알고싶습니다.', a: 'A. 작업 일정은 마이페이지 > 접수/배송 내역에서 확인하실 수 있습니다. 현재 공정 단계 또한 실시간으로 업데이트되니 참고 부탁드립니다.' }
            ]
        };

        function selectInquiryType(chip, type) {
            // 1. Toggle chip (In edit mode, this is disabled via CSS, but logic remains for init)
            const group = chip.closest('.tabs-scroll-wrapper');
            group.querySelectorAll('.single-chip').forEach(c => c.classList.replace('single-chip-on', 'single-chip-off'));
            chip.classList.replace('single-chip-off', 'single-chip-on');

            // 2. Show/hide form sections
            const container = document.getElementById('form-container');
            container.querySelectorAll('.form-section').forEach(section => {
                const types = section.dataset.formType.split(' ');
                if (types.includes(type)) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });
            
            // 3. [MODIFIED] Show/hide sub-category sections
            const subCategoryContainer = document.getElementById('sub-category-container');
            subCategoryContainer.querySelectorAll('.form-group[data-sub-category-for]').forEach(section => {
                if (section.dataset.subCategoryFor === type) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });

            // 4. Update conditional fields (Sub-category and FAQ)
            if (type === 'AS') {
                const subCategorySelect = document.getElementById('sub-category-select-as');
                const faqList = document.getElementById('faq-list-as');
                
                subCategorySelect.innerHTML = '';
                faqList.innerHTML = '';
                
                subCategoryOptions['AS'].forEach(option => {
                    subCategorySelect.add(new Option(option, option));
                });
                faqItems['AS'].forEach(item => {
                    faqList.innerHTML += `
                        <div class="faq-item" onclick="showFaqAnswer('${item.q}', '${item.a.replace(/'/g, "\\'").replace(/"/g, "&quot;")}')">
                            <span>${item.q}</span>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 6l6 6l-6 6" /></svg>
                        </div>`;
                });

            } else if (type === 'DEFAULT') {
                const categoryName = chip.textContent.trim(); // "출고/배송", "제작" etc.
                const subCategorySelect = document.getElementById('sub-category-select-default');
                const faqList = document.getElementById('faq-list-default');
                
                subCategorySelect.innerHTML = '';
                faqList.innerHTML = '';
                
                const options = subCategoryOptions['DEFAULT'][categoryName] || [];
                options.forEach(option => {
                    subCategorySelect.add(new Option(option, option));
                });
                
                const faqItemsForType = faqItems['DEFAULT'];
                if (faqItemsForType && faqItemsForType.length > 0) {
                    faqList.style.display = 'flex';
                    document.querySelector('[data-form-type="DEFAULT"] .section-title').style.display = 'block';
                    faqItemsForType.forEach(item => {
                        faqList.innerHTML += `
                            <div class="faq-item" onclick="showFaqAnswer('${item.q}', '${item.a.replace(/'/g, "\\'").replace(/"/g, "&quot;")}')">
                                <span>${item.q}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 6l6 6l-6 6" /></svg>
                            </div>`;
                    });
                } else {
                     faqList.style.display = 'none';
                     document.querySelector('[data-form-type="DEFAULT"] .section-title').style.display = 'none';
                }
            } else if (type === 'QNA') {
                const subCategorySelect = document.getElementById('sub-category-select-qna');
                subCategorySelect.innerHTML = '';
                subCategoryOptions['QNA'].forEach(option => {
                    subCategorySelect.add(new Option(option, option));
                });
            }
        }
        
        function selectPrivacy(chip) {
             const group = chip.closest('#privacy-chips');
             group.querySelectorAll('.single-chip').forEach(c => c.classList.replace('single-chip-on', 'single-chip-off'));
             chip.classList.replace('single-chip-off', 'single-chip-on');
        }
        
        // --- FAQ Answer Sheet Logic ---
        function showFaqAnswer(question, answer) {
            document.getElementById('faq-answer-q').textContent = question;
            document.getElementById('faq-answer-a').innerHTML = answer.replace(/\n/g, '<br>'); // Handle newlines
            showFaqAnswerSheet();
        }
        
        
        // --- [NEW] Order Combobox Logic ---
        
        // Sample data
        const sampleOrders = [
            { id: 'sw409058', date: '2025-08-08', title: '명함 - 임원명함' },
            { id: 'sw409057', date: '2025-08-08', title: '전단지 - 삼성SDS전단지' },
            { id: 'sw409056', date: '2025-08-07', title: '명함 - SAMPLE' },
            { id: 'sw234332', date: '2025-08-06', title: '대봉투 - 무제' },
            { id: 'sw234331', date: '2025-08-06', title: '샤이니명함 - 김길동_명함' }
        ];

        function populateOrderDropdowns() {
            const dropdownAS = document.getElementById('order-dropdown-as');
            const dropdownDefault = document.getElementById('order-dropdown-default');
            dropdownAS.innerHTML = '';
            dropdownDefault.innerHTML = '';

            sampleOrders.forEach(order => {
                const itemHtml = `
                    <div class="combobox-item" onmousedown="selectOrderFromDropdown('${order.id}', '${order.date}')">
                        <strong>${order.id}</strong> (${order.title})
                        <span class="order-date">${order.date}</span>
                    </div>`;
                dropdownAS.innerHTML += itemHtml;
                dropdownDefault.innerHTML += itemHtml;
            });
        }
        
        function filterOrderList(inputEl, type) {
            const filter = inputEl.value.toLowerCase();
            const dropdown = document.getElementById(`order-dropdown-${type}`);
            const items = dropdown.getElementsByClassName('combobox-item');
            let hasVisibleItems = false;
            
            Array.from(items).forEach(item => {
                const text = item.textContent.toLowerCase();
                if (text.includes(filter)) {
                    item.style.display = '';
                    hasVisibleItems = true;
                } else {
                    item.style.display = 'none';
                }
            });
            dropdown.style.display = hasVisibleItems ? 'block' : 'none';
        }

        function selectOrderFromDropdown(orderId, orderDate) {
            let type = document.querySelector('[data-form-type="AS"]').style.display === 'block' ? 'as' : 'default';
            
            const orderInput = document.getElementById(`order-number-${type}`);
            const orderDateGroup = document.getElementById(`order-date-group-${type}`);
            const orderDateValue = document.getElementById(`order-date-${type}`);
            
            if (orderInput) {
                orderInput.value = orderId;
                isFormDirty = true;
            }
            if (orderDateGroup && orderDateValue) {
                orderDateValue.textContent = orderDate;
                orderDateGroup.style.display = 'block';
            }
            
            // This will trigger the onblur event, which hides the dropdown
        }
        
        function showOrderDropdown(type) {
            // Re-filter or just show all
            const inputEl = document.getElementById(`order-number-${type}`);
            filterOrderList(inputEl, type);
        }
        
        function hideOrderDropdown(type) {
            // Use a timeout to allow click on dropdown item to register
            setTimeout(() => {
                const dropdown = document.getElementById(`order-dropdown-${type}`);
                if (dropdown) dropdown.style.display = 'none';
            }, 200);
        }

        // --- Order List Modal Logic (Fallback) ---
        function showOrderListModal() {
            openModal('order-list-modal-overlay');
        }

        function selectOrder(orderId, orderDate) {
            // Find the visible input field for order number
            let orderInput, orderDateGroup, orderDateValue;
            
            if (document.querySelector('[data-form-type="AS"]').style.display === 'block') {
                orderInput = document.getElementById('order-number-as');
                orderDateGroup = document.getElementById('order-date-group-as');
                orderDateValue = document.getElementById('order-date-as');
            } else {
                orderInput = document.getElementById('order-number-default');
                orderDateGroup = document.getElementById('order-date-group-default');
                orderDateValue = document.getElementById('order-date-default');
            }
            
            if (orderInput) {
                orderInput.value = orderId;
                isFormDirty = true;
            }
            if (orderDateGroup && orderDateValue) {
                orderDateValue.textContent = orderDate;
                orderDateGroup.style.display = 'block';
            }
            
            closeModal('order-list-modal-overlay');
        }
        
        // --- [NEW] Existing File Logic ---
        function removeExistingFile(button) {
            // In a real app, this would also call an API to delete the file
            button.parentElement.remove();
            isFormDirty = true;
            console.log("Existing file removed.");
        }
        

        // --- Initialize (Event listeners etc.) ---
        document.addEventListener('DOMContentLoaded', () => {
            // [MODIFIED] Initialize "AS" form state for editing
            selectInquiryType(document.querySelector('.single-chip[data-type="AS"]'), 'AS');
            
            // [NEW] Set pre-selected sub-category
            const asSelect = document.getElementById('sub-category-select-as');
            if (asSelect) {
                // Set value based on `qna_detail(AS).html` title
                asSelect.value = '용지/인쇄/재단/가공/포장'; 
            }
            
            // [NEW] Populate combobox dropdowns
            populateOrderDropdowns();
            
            // Modal overlay click-to-close listeners
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    if (e.target.id === overlay.id) {
                        closeModal(overlay.id);
                    }
                });
            });
            
            // Add event listeners for form dirty check
            document.querySelectorAll('#form-container input, #form-container textarea, .inquiry-type-section select').forEach(el => {
                // Set initial state as not dirty
                el.addEventListener('input', () => { isFormDirty = true; });
                el.addEventListener('change', () => { isFormDirty = true; }); // For select
            });
            document.getElementById('as-policy-main-checkbox').closest('.checkbox-text').addEventListener('click', () => {
                isFormDirty = true;
            });
             document.getElementById('privacy-checkbox-main').closest('.checkbox-text').addEventListener('click', () => {
                isFormDirty = true;
            });
        });

    </script>
</body>
</html>